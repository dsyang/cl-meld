#!/opt/local/bin/sbcl --noinform --control-stack-size 32 --noprint --script

(defvar *params* (rest sb-ext:*posix-argv*))

(when (null *params*)
 	(format t "Usage: compile-file <file1 output1> <file2 output2> ...~%")
	(quit))

(format t "==> Launching the Lisp system...~%")
(require 'asdf)
(setf asdf:*asdf-verbose* nil) ; die messages die!
(require 'asdf-install)
(push "/Users/flaviocruz/Projects/LispMeld/" asdf:*central-registry*)
(format t "==> Loading CL-Meld...~%")
(asdf:oos 'asdf:load-op 'cl-meld)

(defun compile-file-list (params)
 (unless (null params)
	(format t "==> Compiling file ~a~%      to ~a.m~%" (first params) (second params))
	(cl-meld:meld-compile (first params) (second params))
	(compile-file-list (rest (rest params)))))

(compile-file-list *params*)
